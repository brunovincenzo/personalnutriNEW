â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 RESUMO FINAL - TUDO PRONTO PARA COPIAR E COLAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ O QUE FOI FEITO AUTOMATICAMENTE:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… ARQUIVOS SWIFT ATUALIZADOS (jÃ¡ no repositÃ³rio):
   1. IAPManager.swift
      - MÃ©todo purchase() agora aceita appAccountToken
      - Define applicationUsername no SKPayment para validaÃ§Ã£o server-side

   2. WebViewController.swift
      - Injeta USER_EMAIL e APP_UUID via WKUserScript
      - Define handler padrÃ£o window.iapResult() para receber respostas
      - Carrega pÃ¡gina remota como prioridade (produÃ§Ã£o-like)
      - Fallback para assinatura.html local se remoto falhar
      - Passa appAccountToken ao IAPManager

   3. PersonalNutriApp.swift
      - IAPManager.shared.start() chamado na inicializaÃ§Ã£o

âœ… ARQUIVOS DE RECURSOS (jÃ¡ no repositÃ³rio):
   1. PersonalNutri/PersonalNutri/Resources/assinatura.html
      - PÃ¡gina de teste local completa com todos os botÃµes
      - Funciona sem internet para testes

   2. PersonalNutri/PersonalNutri/PersonalNutri.storekit
      - ConfiguraÃ§Ã£o StoreKit com 3 produtos prontos:
        â€¢ com.t800solucoes.personalnutri.mensal.1
        â€¢ com.t800solucoes.personalnutri.semestral.1
        â€¢ com.t800solucoes.personalnutri.anual.1


ğŸ”§ O QUE VOCÃŠ PRECISA FAZER NO XCODE (6 PASSOS SIMPLES):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PASSO 1: Abrir o projeto
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Terminal (copie e cole):
  open PersonalNutri/PersonalNutri.xcodeproj

Resultado esperado: Xcode abre com o projeto.


PASSO 2: Adicionar arquivo PersonalNutri.storekit ao target
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
No Xcode:
  a) File > Add Files to "PersonalNutri"...
  b) Navegue atÃ©: PersonalNutri/PersonalNutri/PersonalNutri.storekit
  c) Marque "Copy items if needed"
  d) Em "Add to targets", marque "PersonalNutri"
  e) Clique "Add"

Resultado esperado: Arquivo aparece na coluna esquerda do Xcode.


PASSO 3: Verificar Target Membership de todos os arquivos principais
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
No Xcode, na coluna esquerda, clique em cada arquivo (um por um):
  â€¢ IAPManager.swift
  â€¢ WebViewController.swift
  â€¢ PersonalNutriApp.swift
  â€¢ assinatura.html
  â€¢ PersonalNutri.storekit

Para cada arquivo:
  a) Selecione o arquivo
  b) Na aba direita (File Inspector), procure "Target Membership"
  c) Confirme que "PersonalNutri" estÃ¡ MARCADO (checkbox âœ“)
  d) Se nÃ£o estiver, clique para marcar

Resultado esperado: Todos os arquivos tÃªm "PersonalNutri" marcado.


PASSO 4: Habilitar In-App Purchase Capability
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
No Xcode:
  a) Clique no projeto "PersonalNutri" (raiz, coluna esquerda)
  b) Selecione o target "PersonalNutri"
  c) Clique na aba "Signing & Capabilities"
  d) Clique no botÃ£o "+ Capability" (topo esquerdo)
  e) Na caixa de busca, procure "In-App Purchase"
  f) Clique duas vezes em "In-App Purchase"

Resultado esperado: VocÃª vÃª "In-App Purchase" listado em Capabilities.


PASSO 5: Configurar StoreKit Configuration
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
No Xcode:
  a) Product > Scheme > Edit Scheme...
  b) Selecione "Run" (lado esquerdo)
  c) Clique na aba "Options"
  d) Em "StoreKit Configuration", selecione "PersonalNutri.storekit"
  e) Clique "Close"

Resultado esperado: Scheme agora usa PersonalNutri.storekit para simular compras.


PASSO 6: Conectar iPhone e rodar
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
No Mac:
  a) Conecte seu iPhone via USB ao Mac
  b) Clique em "Trust" no iPhone para confiar no Mac
  c) Ao Xcode, topo central, selecione seu iPhone (nÃ£o Simulator)
  d) Clique no botÃ£o Play (â–¶) para buildar e rodar

Resultado esperado: 
  - Console Xcode mostra "Build Succeeded"
  - App abre no iPhone mostrando a pÃ¡gina de assinatura


ğŸ§ª TESTAR A PONTE IAP NO IPHONE:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Na app no seu iPhone:

1. TESTE DA BRIDGE:
   Clique em "TESTE IAP BRIDGE"
   â†’ VocÃª deve ver um alerta ou mensagem de status
   â†’ No console do Xcode, procure por "ğŸ DEBUG - ponte JS â†’ iOS funcionando!"

2. COMPRAR MENSAL:
   Clique em "Mensal"
   â†’ StoreKit simularÃ¡ uma tela de confirmaÃ§Ã£o de compra
   â†’ ApÃ³s confirmar, vocÃª verÃ¡ a resposta (status: "success" ou "cancelled")

3. RESTAURAR COMPRAS:
   Clique em "Restaurar Compras"
   â†’ VocÃª verÃ¡ uma resposta (lista de compras ou "nenhuma compra para restaurar")

4. VERIFICAR LOGS:
   No console do Xcode (Cmd+Shift+C):
     - "ğŸ”µ WebViewController.viewDidLoad"
     - "ğŸ›’ SolicitaÃ§Ã£o de compra: com.t800solucoes.personalnutri.mensal.1"
     - "âœ… Resultado IAP enviado ao JS"


ğŸ“ COPIAR/COLAR PARA PRODUÃ‡ÃƒO (Seu servidor):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Arquivo: assinatura_PHP_FINAL.txt (neste repositÃ³rio)

InstruÃ§Ãµes:
  1. Abra o arquivo assinatura_PHP_FINAL.txt
  2. Procure pela seÃ§Ã£o "OPÃ‡ÃƒO 1: Manter sua pÃ¡gina .php..."
  3. Copie todo o cÃ³digo PHP (entre "<?php" e "</html>")
  4. Cole no seu servidor em assinatura.php (ou crie novo arquivo)
  5. Teste no navegador (deve funcionar normalmente)
  6. Teste no app (clique nos botÃµes de assinatura)


âš ï¸  IMPORTANTE ANTES DE SUBMETER Ã€ APPLE:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. REMOVA CÃ“DIGO DE DEBUG:
   - Comente ou remova o botÃ£o "TESTE IAP BRIDGE" do HTML/PHP
   - Remova alerts de debug; use UI apropriada (toast, modal, etc.)
   - Remova ou configure console.log() para production (log nÃ­vel INFO)

2. IMPLEMENTE VALIDAÃ‡ÃƒO SERVER-SIDE:
   - Crie um endpoint PHP que valide recibos com a Apple
   - Use App Store Server API ou verifyReceipt endpoint

3. CONFIGURE PRODUCT IDs NO APP STORE CONNECT:
   - Acesse appstoreconnect.apple.com
   - Na sua app, vÃ¡ para In-App Purchases
   - Crie os 3 produtos com os IDs exatos:
     â€¢ com.t800solucoes.personalnutri.mensal.1
     â€¢ com.t800solucoes.personalnutri.semestral.1
     â€¢ com.t800solucoes.personalnutri.anual.1
   - Defina preÃ§os, descriÃ§Ãµes, artworks, etc.

4. TESTE COM SANDBOX TESTER:
   - Crie uma conta Sandbox no App Store Connect (Users and Access > Sandbox)
   - FaÃ§a login no iPhone com a sandbox account
   - Instale a app via TestFlight
   - Teste todos os fluxos (mensal, semestral, anual, restore)

5. SUBMETA PARA REVISÃƒO:
   - Certifique que tudo estÃ¡ "Ready to Submit"
   - Preencha screenshots, descriÃ§Ã£o, nota de liberaÃ§Ã£o, etc.
   - Submeta!


ğŸ“‚ ARQUIVOS CRIADOS/ATUALIZADOS (local):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ“ PersonalNutri/PersonalNutri/IAPManager.swift (atualizado)
âœ“ PersonalNutri/PersonalNutri/WebViewController.swift (atualizado)
âœ“ PersonalNutri/PersonalNutri/PersonalNutriApp.swift (atualizado)
âœ“ PersonalNutri/PersonalNutri/Resources/assinatura.html (novo)
âœ“ PersonalNutri/PersonalNutri/PersonalNutri.storekit (novo)


ğŸ†˜ ALGO DEU ERRADO? VERIFIQUE:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ERROR: "Product nÃ£o encontrado"
â†’ Produto nÃ£o estÃ¡ em StoreKit config ou ProductIds nÃ£o coincidem

ERROR: "Compras desativadas"
â†’ iPhone nÃ£o tem capacidade IAP habilitada; verifique Capabilities

ERROR: PÃ¡gina nÃ£o carrega
â†’ Verifique URL remota (https://t800robodetreinos.com.br/appview/assinatura.php)
â†’ Se remota falhar, tente assinatura.html local

ERROR: window.webkit undefined
â†’ A pÃ¡gina nÃ£o estÃ¡ sendo executada no WKWebView do app
â†’ Pode ser resultado de carregamento de origem diferente (CORS, sandboxing)

LOGS NÃƒO APARECEM NO CONSOLE:
â†’ Xcode > View > Debug Area > Show Console (ou Cmd+Shift+C)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 FIM DO RESUMO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Qualquer dÃºvida, consulte os logs do Xcode ou abra Safari Developer Tools
(iPhone: Settings > Safari > Advanced > Web Inspector > ON)
